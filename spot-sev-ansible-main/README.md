# spot-sev-ansible
Ansible playbooks for deploying the Spot 7 LOG3900 project backend.  

## Prerequisites
- Ansible  


## How to use this script ? 
This script needs to be run after the [terraform script](https://gitlab.com/polytechnique-montr-al/log3900/24-1/equipe-103/spot-sev-tf).  

The inventory for this playbook is generated by the terraform script. To access it, you need to run the terraform script first. Then you need to pull the state with : 

```bash
terraform state pull > terraform.tfstate
```
This pulls the state from gitlab to your local machine.  
The `inventory.yaml` uses that file to generate the inventory.  

After that you can run the playbook in the `spot-sev-tf` folder with : 
```bash 
ansible-playbook -i inventory.yaml ../spot-sev-ansible/playbook.yaml
```
### Var files 
The var file to fill follows the structure as `vars.yaml.example`. 


## What roles are there ?  
### `init`
This role updates the virtual machine to the latets version of ubuntu and installs docker.  
### `mongo`
This role creates a docker container for mongo and sets up the database.
### `traefik`
This role creates a docker container for traefik, sets up the reverse proxy and sets up the letsecnrypt acme challenge.  

### `backend`
***This role is not working yet***
This role creates a docker container for the backend and sets up the backend.